From 45bd514f5ec3432d58cb162693e6b4a1b9f54bef Mon Sep 17 00:00:00 2001
From: Mark Nauwelaerts <mark.nauwelaerts@collabora.co.uk>
Date: Fri, 7 Aug 2009 13:06:28 +0200
Subject: [PATCH] baseparse: fix minor memory leak

---
 gst/aacparse/gstbaseparse.c  |    1 +
 gst/amrparse/gstbaseparse.c  |    1 +
 gst/flacparse/gstbaseparse.c |    1 +
 3 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/gst/aacparse/gstbaseparse.c b/gst/aacparse/gstbaseparse.c
index 3d6f543..cc865e6 100644
--- a/gst/aacparse/gstbaseparse.c
+++ b/gst/aacparse/gstbaseparse.c
@@ -922,6 +922,7 @@ gst_base_parse_chain (GstPad * pad, GstBuffer * buffer)
           GST_DEBUG_OBJECT (parse,
               "found valid frame but not enough data available (only %d bytes)",
               gst_adapter_available (parse->adapter));
+          gst_buffer_unref (tmpbuf);
           goto done;
         }
         break;
diff --git a/gst/amrparse/gstbaseparse.c b/gst/amrparse/gstbaseparse.c
index aade5b5..0065043 100644
--- a/gst/amrparse/gstbaseparse.c
+++ b/gst/amrparse/gstbaseparse.c
@@ -922,6 +922,7 @@ gst_base_parse_chain (GstPad * pad, GstBuffer * buffer)
           GST_DEBUG_OBJECT (parse,
               "found valid frame but not enough data available (only %d bytes)",
               gst_adapter_available (parse->adapter));
+          gst_buffer_unref (tmpbuf);
           goto done;
         }
         break;
diff --git a/gst/flacparse/gstbaseparse.c b/gst/flacparse/gstbaseparse.c
index 2ce1a11..5d89dc5 100644
--- a/gst/flacparse/gstbaseparse.c
+++ b/gst/flacparse/gstbaseparse.c
@@ -1032,6 +1032,7 @@ gst_base_parse_chain (GstPad * pad, GstBuffer * buffer)
           GST_DEBUG_OBJECT (parse,
               "found valid frame but not enough data available (only %d bytes)",
               gst_adapter_available (parse->adapter));
+          gst_buffer_unref (tmpbuf);
           goto done;
         }
         break;
